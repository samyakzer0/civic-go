<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Key Tester - CivicGo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .api-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        button.secondary {
            background: #6c757d;
        }
        button.secondary:hover {
            background: #545b62;
        }
        .result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .loading {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .instructions {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .instructions h3 {
            margin-top: 0;
            color: #0056b3;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîë API Key Tester</h1>
            <p>Test your Clarifai and Hugging Face API keys for CivicGo</p>
        </div>

        <div class="instructions">
            <h3>üìã Instructions</h3>
            <ol>
                <li>Get your API keys from the respective websites</li>
                <li>Enter them in the fields below</li>
                <li>Click "Test API Key" for each service</li>
                <li>Add working keys to your <code>.env</code> file</li>
            </ol>
        </div>

        <div class="api-section">
            <h2>üéØ Clarifai API</h2>
            <p><strong>Free Limit:</strong> 5,000 operations/month</p>
            <p><strong>Get Key:</strong> <a href="https://clarifai.com/" target="_blank">clarifai.com</a></p>

            <div class="input-group">
                <label for="clarifai-key">API Key:</label>
                <input type="text" id="clarifai-key" placeholder="Enter your Clarifai API key">
            </div>

            <button onclick="testClarifai()">Test Clarifai API Key</button>
            <div id="clarifai-result" class="result"></div>
        </div>

        <div class="api-section">
            <h2>ü§ó Hugging Face API</h2>
            <p><strong>Free Limit:</strong> 30,000 requests/month</p>
            <p><strong>Get Token:</strong> <a href="https://huggingface.co/" target="_blank">huggingface.co</a></p>

            <div class="input-group">
                <label for="huggingface-key">API Token:</label>
                <input type="text" id="huggingface-key" placeholder="Enter your Hugging Face token">
            </div>

            <button onclick="testHuggingFace()">Test Hugging Face API Key</button>
            <div id="huggingface-result" class="result"></div>
        </div>

        <div class="api-section">
            <h2>üìù Add to .env File</h2>
            <p>Once you have working API keys, add them to your <code>.env</code> file:</p>
            <pre>
# Add these lines to your .env file:
VITE_CLARIFAI_API_KEY=your_clarifai_key_here
VITE_HUGGINGFACE_API_KEY=your_huggingface_token_here</pre>

            <button class="secondary" onclick="copyEnvExample()">Copy .env Template</button>
        </div>
    </div>

    <script>
        async function testClarifai() {
            const apiKey = document.getElementById('clarifai-key').value.trim();
            const resultDiv = document.getElementById('clarifai-result');

            if (!apiKey) {
                showResult(resultDiv, 'Please enter an API key', 'error');
                return;
            }

            showResult(resultDiv, 'Testing API key...', 'loading');

            try {
                const response = await fetch('https://api.clarifai.com/v2/models/general-image-recognition/versions/aa7f35c01e0642fda5cf400f543e7c7f/outputs', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Key ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        inputs: [{
                            data: {
                                image: {
                                    base64: 'iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=='
                                }
                            }
                        }]
                    })
                });

                if (response.ok) {
                    showResult(resultDiv, '‚úÖ API key is working! You can use Clarifai in your app.', 'success');
                } else {
                    showResult(resultDiv, `‚ùå API key failed: ${response.status} ${response.statusText}`, 'error');
                }
            } catch (error) {
                showResult(resultDiv, `‚ùå Error: ${error.message}`, 'error');
            }
        }

        async function testHuggingFace() {
            const apiKey = document.getElementById('huggingface-key').value.trim();
            const resultDiv = document.getElementById('huggingface-result');

            if (!apiKey) {
                showResult(resultDiv, 'Please enter an API token', 'error');
                return;
            }

            showResult(resultDiv, 'Testing API token...', 'loading');

            try {
                const response = await fetch('https://api-inference.huggingface.co/models/microsoft/resnet-50', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/octet-stream'
                    },
                    body: new Uint8Array([137, 80, 78, 71, 13, 10, 26, 10, 0, 0, 0, 13, 73, 72, 68, 82, 0, 0, 0, 1, 0, 0, 0, 1, 8, 6, 0, 0, 0, 31, 21, 196, 137, 0, 0, 0, 11, 73, 68, 65, 84, 120, 156, 99, 248, 15, 0, 0, 1, 0, 1, 0, 24, 221, 219, 118, 0, 0, 0, 0, 73, 69, 78, 68, 174, 66, 96, 130])
                });

                if (response.ok) {
                    showResult(resultDiv, '‚úÖ API token is working! You can use Hugging Face in your app.', 'success');
                } else {
                    showResult(resultDiv, `‚ùå API token failed: ${response.status} ${response.statusText}`, 'error');
                }
            } catch (error) {
                showResult(resultDiv, `‚ùå Error: ${error.message}`, 'error');
            }
        }

        function showResult(element, message, type) {
            element.textContent = message;
            element.className = `result ${type}`;
            element.style.display = 'block';
        }

        function copyEnvExample() {
            const envText = `# Add these lines to your .env file:
VITE_CLARIFAI_API_KEY=your_clarifai_key_here
VITE_HUGGINGFACE_API_KEY=your_huggingface_token_here`;

            navigator.clipboard.writeText(envText).then(() => {
                alert('Environment variables copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = envText;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Environment variables copied to clipboard!');
            });
        }
    </script>
</body>
</html>
